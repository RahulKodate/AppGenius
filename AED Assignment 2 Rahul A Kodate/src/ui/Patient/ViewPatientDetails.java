package ui.Patient;

import java.awt.CardLayout;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import model.Patient;

/**
 *
 * @author rahulkodate
 */
public class ViewPatientDetails extends javax.swing.JPanel {

    /**
     * Creates new form ViewPatientDetails
     */
    private JPanel userProcessContainer;
    private Patient patient;
    private Boolean editable = Boolean.FALSE;

    public ViewPatientDetails(JPanel userProcessContainer, Patient patient, Boolean editable) {
        initComponents();
        this.userProcessContainer = userProcessContainer;
        this.patient = patient;
        this.editable = editable;

        isLetter("");

        populatePatientDetails();
        updatePatientDetails(this.editable);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        txtPDoctor = new javax.swing.JTextField();
        lblPatientDetails = new javax.swing.JLabel();
        lblPatientID = new javax.swing.JLabel();
        lblInsurance = new javax.swing.JLabel();
        txtPatientID = new javax.swing.JTextField();
        txtInsurance = new javax.swing.JTextField();
        btnSave = new javax.swing.JButton();
        btnUpdate = new javax.swing.JButton();
        btnBack = new javax.swing.JButton();
        lblPDoctor = new javax.swing.JLabel();
        lblPharmacy = new javax.swing.JLabel();
        txtPharmacy = new javax.swing.JTextField();

        setBackground(new java.awt.Color(153, 153, 255));

        txtPDoctor.setFont(new java.awt.Font("Operator Mono", 0, 13)); // NOI18N

        lblPatientDetails.setFont(new java.awt.Font("Georgia", 1, 24)); // NOI18N
        lblPatientDetails.setForeground(new java.awt.Color(255, 255, 255));
        lblPatientDetails.setText("Patient Details");

        lblPatientID.setFont(new java.awt.Font("Georgia", 1, 13)); // NOI18N
        lblPatientID.setForeground(new java.awt.Color(255, 255, 255));
        lblPatientID.setText("Patient ID");

        lblInsurance.setFont(new java.awt.Font("Georgia", 1, 13)); // NOI18N
        lblInsurance.setForeground(new java.awt.Color(255, 255, 255));
        lblInsurance.setText("Innsurance No.");

        txtPatientID.setFont(new java.awt.Font("Operator Mono", 0, 13)); // NOI18N

        txtInsurance.setFont(new java.awt.Font("Operator Mono", 0, 13)); // NOI18N

        btnSave.setBackground(new java.awt.Color(255, 0, 0));
        btnSave.setFont(new java.awt.Font("Georgia", 1, 13)); // NOI18N
        btnSave.setForeground(new java.awt.Color(255, 255, 255));
        btnSave.setText("Save");
        btnSave.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSaveActionPerformed(evt);
            }
        });

        btnUpdate.setBackground(new java.awt.Color(255, 0, 0));
        btnUpdate.setFont(new java.awt.Font("Georgia", 1, 13)); // NOI18N
        btnUpdate.setForeground(new java.awt.Color(255, 255, 255));
        btnUpdate.setText("Update");
        btnUpdate.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnUpdate.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnUpdateActionPerformed(evt);
            }
        });

        btnBack.setBackground(new java.awt.Color(255, 0, 0));
        btnBack.setFont(new java.awt.Font("Georgia", 1, 13)); // NOI18N
        btnBack.setForeground(new java.awt.Color(255, 255, 255));
        btnBack.setText("<- Back");
        btnBack.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        btnBack.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnBackActionPerformed(evt);
            }
        });

        lblPDoctor.setFont(new java.awt.Font("Georgia", 1, 13)); // NOI18N
        lblPDoctor.setForeground(new java.awt.Color(255, 255, 255));
        lblPDoctor.setText("Primary Doctor");

        lblPharmacy.setFont(new java.awt.Font("Georgia", 1, 13)); // NOI18N
        lblPharmacy.setForeground(new java.awt.Color(255, 255, 255));
        lblPharmacy.setText("Preferred Pharmacy");

        txtPharmacy.setFont(new java.awt.Font("Operator Mono", 0, 13)); // NOI18N

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(layout.createSequentialGroup()
                            .addGap(68, 68, 68)
                            .addComponent(btnBack, javax.swing.GroupLayout.PREFERRED_SIZE, 85, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGap(227, 227, 227)
                            .addComponent(lblPatientDetails))
                        .addGroup(layout.createSequentialGroup()
                            .addGap(250, 250, 250)
                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                .addComponent(lblPDoctor, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(lblInsurance, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(lblPatientID))
                            .addGap(225, 225, 225)
                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                .addComponent(txtInsurance, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(txtPDoctor, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(txtPatientID, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGroup(layout.createSequentialGroup()
                            .addGap(334, 334, 334)
                            .addComponent(btnUpdate, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGap(18, 18, 18)
                            .addComponent(btnSave, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(layout.createSequentialGroup()
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(lblPharmacy)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(txtPharmacy, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(273, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(50, 50, 50)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblPatientDetails)
                    .addComponent(btnBack))
                .addGap(53, 53, 53)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtPatientID, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblPatientID))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtPDoctor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblPDoctor))
                .addGap(11, 11, 11)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtInsurance, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblInsurance))
                .addGap(7, 7, 7)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtPharmacy, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblPharmacy))
                .addGap(30, 30, 30)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnSave)
                    .addComponent(btnUpdate))
                .addContainerGap(279, Short.MAX_VALUE))
        );
    }// </editor-fold>//GEN-END:initComponents

  private void btnSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSaveActionPerformed
        // TODO add your handling code here:
        // validations
        if (txtPatientID.getText().
                trim().
                equals("") || txtPDoctor.getText().
                trim().
                equals("") || txtInsurance.getText().
                trim().
                equals("") || txtPharmacy.getText().
                trim().
                equals("") || !isLetter(txtPDoctor.getText()) || !isLetter(txtPharmacy.getText())) {
            JOptionPane.showMessageDialog(this, "Please enter appropriate values!",
                    "Error", JOptionPane.INFORMATION_MESSAGE);
            return;
        }

        try {
            long pid = Long.parseLong(txtPatientID.getText());
            int ins = Integer.parseInt(txtInsurance.getText());
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Please enter appropriate ID and Insurance values!",
                    "Error", JOptionPane.INFORMATION_MESSAGE);
            return;
        }

        patient.setPatientID(Long.parseLong(txtPatientID.getText()));
//    patient.setDoctor(txtPDoctor.getText());
        patient.setInsuranceID(Integer.parseInt(txtInsurance.getText()));
        patient.setPharmacy(txtPharmacy.getText());
        JOptionPane.showMessageDialog(this, "Successfully updated patient details!",
                "Update", JOptionPane.INFORMATION_MESSAGE);
        updatePatientDetails(false);
  }//GEN-LAST:event_btnSaveActionPerformed

  private void btnUpdateActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnUpdateActionPerformed
        // TODO add your handling code here:
        updatePatientDetails(true);
  }//GEN-LAST:event_btnUpdateActionPerformed

  private void btnBackActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnBackActionPerformed
        // TODO add your handling code here:
        userProcessContainer.remove(this);
        CardLayout layout = (CardLayout) userProcessContainer.getLayout();
        layout.previous(userProcessContainer);
  }//GEN-LAST:event_btnBackActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnBack;
    private javax.swing.JButton btnSave;
    private javax.swing.JButton btnUpdate;
    private javax.swing.JLabel lblInsurance;
    private javax.swing.JLabel lblPDoctor;
    private javax.swing.JLabel lblPatientDetails;
    private javax.swing.JLabel lblPatientID;
    private javax.swing.JLabel lblPharmacy;
    private javax.swing.JTextField txtInsurance;
    private javax.swing.JTextField txtPDoctor;
    private javax.swing.JTextField txtPatientID;
    private javax.swing.JTextField txtPharmacy;
    // End of variables declaration//GEN-END:variables

    private void populatePatientDetails() {
        txtPatientID.setText(String.valueOf(patient.getPatientID()));
        txtPDoctor.setText(patient.getDoctor().getFirstName());
        txtInsurance.setText(String.valueOf(patient.getInsuranceID()));
        txtPharmacy.setText(patient.getPharmacy());
    }

    private void updatePatientDetails(Boolean editable) {
        if (editable) {
            txtPatientID.setEnabled(true);
            txtPDoctor.setEnabled(true);
            txtInsurance.setEnabled(true);
            txtPharmacy.setEnabled(true);
        } else {
            txtPatientID.setEnabled(false);
            txtPDoctor.setEnabled(false);
            txtInsurance.setEnabled(false);
            txtPharmacy.setEnabled(false);
        }
    }

    private boolean isLetter(String s) {
        char[] chArr = s.toCharArray();
        for (char c : chArr) {
            if (!Character.isLetter(c)) {
                return false;
            }
        }
        return true;
    }
}
